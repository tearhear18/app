"use strict";angular.module("errandApp",["ngTouch","ui.router","ngStorage"]).config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/"),a.state("index",{url:"/",templateUrl:"views/index.html",controller:"IndexCtrl"}).state("index.login",{url:"login",templateUrl:"views/login.html"}).state("login",{url:"/login",templateUrl:"views/login.html"}).state("index.signup",{url:"signup",templateUrl:"views/signup.html"}).state("index.signup-email",{url:"signup-email",templateUrl:"views/signup-email.html"}).state("index.member",{url:"member",templateUrl:"views/member.html"}).state("user",{url:"/user",templateUrl:"views/user.html",controller:"UserCtrl"})}]).config(["$httpProvider",function(a){a.defaults.headers.common={},a.defaults.headers.post={},a.defaults.headers.put={},a.defaults.headers.patch={}}]),angular.module("errandApp").controller("IndexCtrl",["$scope","$window","$state","server","$sessionStorage","User",function(a,b,c,d,e,f){f.init(),f.is_login()&&c.go("user"),b.fbAsyncInit=function(){FB.init({appId:"981095891944891",status:!0,cookie:!0,xfbml:!0,version:"v2.4"}),FB.getLoginStatus(function(b){"connected"===b.status?FB.api("/me",function(b){a.response=b,c.go("index.member")}):c.go("index")})},a.sign_with_facebook=function(){FB.login(function(a){"connected"===a.status?c.go("user"):"not_authorized"===a.status?(console.log("no not_authorized"),c.go("index")):(console.log("not sure :)"),c.go("index"))},{scope:"public_profile,email"})},a.register=function(a,b){return a.regtype_id=b,a.password!=a.password2?(alert("Please verify your password correctly"),!1):void d.request("register",a,!0).then(function(a){console.log(a),a.data.status?alert(a.data.payload):alert(a.data.payload)},function(){alert("Transaction Failed")})},a.login=function(a){d.request("login",a,!0).then(function(a){console.log(a),e.token=a.data.session,e.uac=a.data.payload.uac,c.go("user")},function(){alert("Transaction failed")})}}]),angular.module("errandApp").controller("UserCtrl",["$scope","User","$state",function(a,b,c){b.is_login()||c.go("index"),a.logout=function(){b.logout(),c.go("index")}}]),angular.module("errandApp").factory("server",["$http","$sessionStorage",function(a,b){var c="http://errands.com.ph/errand-api/index.php",d={};return d.request=function(d,e,f){return a.post(c,{route:d,params:e,session:b.token,debug:f})},d}]),angular.module("errandApp").factory("User",["server","$sessionStorage",function(a,b){var c={};return c.init=function(){a.request("bootloader",{ping:"server_status"},!0).then(function(a){b.token=a.data.session},function(){alert("Server is Offline. Try again later..")})},c.is_login=function(){return"undefined"==typeof b.uac?!1:!0},c.logout=function(){delete b.uac},c}]),angular.module("errandApp").run(["$templateCache",function(a){a.put("views/index.html",'<div class="mainContainer index"> <div class="container-masterX"> <div class="container-masterY"> <div ui-view> <div class="introWrapper text-center"> <div class="errand_icon"></div> <p> Be part of our journey to empower families and busy persons like you to gain more time by reducing footprints in the tradiitonal grocery stores.</p> <button ui-sref="login" class="btn-primary">LOG IN</button> <button ui-sref="index.signup" class="btn-primary">SIGN UP</button> </div> <!--\r\n                <div class="footer-intro">\r\n                    <a class="sign-in-footer" ui-sref="index.login">Already have an account? Login</a>\r\n                </div>           \r\n                --> </div> </div> </div> </div>'),a.put("views/login.html",'<div class="introWrapper text-center"> <div class="errand_icon"></div> <div class="form_groupa"> <form ng-submit="login(user)"> <input type="email" class="form-log" placeholder="Email Address" ng-model="user.email" required> <div class="input-prepend"><input type="password" class="form-pass" placeholder="Password" ng-model="user.password" required><span class="add-on"> <i class="fa fa-eye"></i></span></div> <button type="submit" class="btn-primary">Log in</button> </form> <h6><a ui-sref="index.forgotpassword">Forgot password</a></h6> </div> <div class="choice"><a href="#"><i class="fa fa-facebook"></i> Log in with Facebook</a></div> <div class="choice"><a href="#"><i class="fa fa-google"></i> Log in with Google</a></div> </div> <div class="footer-intro"> <a class="sign-in-footer" href="#">Dont have an account? Signup</a> </div>'),a.put("views/member.html",'<div class="memberWrapper"> <!-- <div class="profile">\r\n		<img class="profile_pic" src="//graph.facebook.com/{{response.id}}/picture?type=normal">\r\n	</div>\r\n	<div class="user_info">\r\n		\r\n		<p class="text-center">{{response.name}}</p>4\r\n		\r\n	</div> --> <h1>MEMBER PAGE</h1> </div>'),a.put("views/signup-email.html",'<div class="introWrapper text-center"> <div class="errand_icon"></div> <div class="signemail"> <form ng-submit="register( user,3 )"> <input ng-model="user.email" type="email" class="form-log" placeholder="Email Address" required> <input ng-model="user.password" type="password" class="form-log" placeholder="Password" required> <input ng-model="user.password2" type="password" class="form-log" placeholder="Confirm Password" required> <button type="submit" class="btn-primary">Signup</button> </form> </div> </div> <div class="footer-intro"> <a class="sign-in-footer" href="#">Dont have an account? Signup</a> </div>'),a.put("views/signup.html",'<div class="errand_icon"></div> <div class="form_group"> <button ng-click="sign_with_facebook()" class="button signup-fb text-left">Sign up with Facebook </button> <button class="button signup-google text-left">Sign up with Google</button> </div> <div class="otheractions"> <a class="signup-email" ui-sref="index.signup-email">Sign up with Email</a> </div>'),a.put("views/user.html",'<div class="mainContainer index"> <div class="container-masterX"> <div class="container-masterY"> <div ui-view> <div class="memberWrapper"> <h1>MEMBER PAGE</h1> <button ng-click="logout()">LOGOUT</button> </div> </div> </div> </div> </div>')}]);